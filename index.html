<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>St. Peter The Apostle - Airport Parish</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Merriweather:700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap" rel="stylesheet">
</head>
<body>
    <header class="site-header">
        <div class="branding">
            <img src="assets/img/logo.png" alt="Parish Logo" class="parish-logo" style="display:none;" />
            <h1>St. Peter The Apostle - Airport Parish</h1>
        </div>
        <div id="nav-container"></div>
    </header>

    <section class="hero" style="background-image: url('assets/img/hero-church.jpg');">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <h2 class="hero-title">St. Peter The Apostle - Airport Parish</h2>
            <p class="hero-subtitle">A welcoming and vibrant community of faith</p>
        </div>
    </section>

    <main class="main-content-container">
        <section class="main-column">
            <div class="section-about">
                <h1 class="section-title">About the Church</h1>
                <p>St. Peter The Apostle - Airport Parish is a vibrant and welcoming community of faith, committed to serving God and our neighbors. We believe in creating a space where everyone feels at home and can grow in their spiritual journey. Our parish is built on the foundation of love, compassion, and service, guided by the teachings of Jesus Christ. We offer various ministries and programs to meet the needs of our diverse community, fostering a strong sense of belonging and a shared purpose.</p>
                <hr class="section-divider">
            </div>

            <div class="section-mass-times">
                <h2 class="section-subtitle">Main Mass Times</h2>
                <ul class="mass-times-list">
                    <li><b>Sunday:</b> 8:00 AM & 10:00 AM</li>
                    <li><b>Weekdays:</b> 7:00 AM</li>
                </ul>
                <a href="mass-times.html" class="view-all-link">View All Mass Times</a>
            </div>

            <div class="section-announcements">
                <h2 class="section-subtitle">Parish Announcements</h2>
                <ul id="announcements-list" class="announcements-list">
                    </ul>
            </div>

            <div class="section-blog">
                <h2 class="section-subtitle">Parish Blog</h2>
                <div id="blog-slider" class="blog-slider">
                    <p>Loading blog posts...</p>
                </div>
                <div id="blog-modal" class="blog-modal" style="display:none;">
                    <div class="blog-modal-content">
                        <span id="blog-modal-close" class="blog-modal-close">&times;</span>
                        <div id="blog-modal-slider">
                            <button id="blog-modal-prev" class="blog-modal-nav">&#10094;</button>
                            <img id="blog-modal-img" class="blog-modal-img" src="" alt="Blog Image" />
                            <button id="blog-modal-next" class="blog-modal-nav">&#10095;</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <aside class="sidebar-column">
            <div class="sidebar-section">
                <h3 class="sidebar-title">Daily Readings</h3>
                <label for="readings-date">Select Date:</label>
                <input type="date" id="readings-date" name="readings-date" />
                <div id="readings-content">
                    </div>
            </div>
            <div class="sidebar-section">
                <h3 class="sidebar-title">Upcoming Parish Events</h3>
                <ul id="events-list" class="events-list">
                    </ul>
            </div>

            <div class="sidebar-section">
                <h3 class="sidebar-title">Recent Bulletins</h3>
                <div class="bulletins-controls">
                    <label for="bulletin-section">Section:</label>
                    <select id="bulletin-section">
                        <option value="All">All</option>
                        <option value="Homily">Homily</option>
                        <option value="Announcement">Announcement</option>
                        <option value="Event">Event</option>
                    </select>
                </div>
                <div id="bulletins-list" class="bulletins-list">
                    </div>
                <div id="bulletin-error" style="display:none;color:#c00;margin-top:8px;"></div>
                <div class="bulletin-footer">
                    <a href="bulletin.html" class="view-all-link">View All Bulletins</a>
                </div>
            </div>
        </aside>
    </main>

    <div id="footer-container"></div>
    <script>
        // Dynamic bulletin logic remains the same
        const bulletinsList = document.getElementById('bulletins-list');
        const bulletinError = document.getElementById('bulletin-error');
        const sectionSelect = document.getElementById('bulletin-section');

        function parseBulletinFilename(filename) {
            const match = filename.match(/^(\w+)-(\d{4}-\d{2}-\d{2})-(.+)\.pdf$/i);
            if (!match) return null;
            const [year, month, day] = match[2].split('-');
            const dateObj = new Date(`${year}-${month}-${day}`);
            const dateStr = dateObj.toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' });
            return {
                section: match[1].charAt(0).toUpperCase() + match[1].slice(1),
                date: match[2],
                title: `${match[3].replace(/-/g, ' ')} (${dateStr})`,
                url: `assets/bulletins/${filename}`
            };
        }

        function renderBulletins(bulletins, section = 'All') {
            bulletinsList.innerHTML = '';
            let filtered = bulletins;
            if (section !== 'All') {
                filtered = bulletins.filter(b => b.section === section);
            }
            filtered = filtered.sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
            if (filtered.length === 0) {
                bulletinsList.innerHTML = '<li>No bulletins found.</li>';
                return;
            }
            filtered.forEach(bulletin => {
                const li = document.createElement('li');
                li.className = 'bulletin-item';
                li.innerHTML = `
                    <a href="${bulletin.url}" target="_blank" class="bulletin-link">
                        ${bulletin.title}
                    </a>
                `;
                bulletinsList.appendChild(li);
            });
        }

        fetch('data/bulletins.json')
            .then(response => response.json())
            .then(data => {
                const bulletins = data.map(b => parseBulletinFilename(b.name)).filter(Boolean);
                if (bulletins.length === 0) {
                    bulletinsList.innerHTML = '<li>No bulletins found.</li>';
                    return;
                }
                renderBulletins(bulletins);
                sectionSelect.addEventListener('change', function() {
                    renderBulletins(bulletins, this.value);
                });
            })
            .catch((err) => {
                bulletinError.style.display = 'block';
                bulletinError.textContent = 'No bulletins found (fetch error).';
                bulletinsList.innerHTML = '';
                console.error('Bulletin fetch error:', err);
            });

        // Parish Announcements
        const announcementsList = document.getElementById('announcements-list');
        announcementsList.innerHTML = '<li>Loading announcements...</li>';
        fetch('data/parish-announcements.json')
            .then(response => response.json())
            .then(announcements => {
                announcementsList.innerHTML = '';
                if (!Array.isArray(announcements) || announcements.length === 0) {
                    announcementsList.innerHTML = '<li>No parish announcements at this time.</li>';
                    return;
                }
                announcements.forEach(announcement => {
                    const li = document.createElement('li');
                    li.className = 'list-item';
                    li.innerHTML = `
                        <h4>${announcement.title}</h4>
                        <p>${announcement.date}</p>
                        <p>${announcement.description}</p>
                    `;
                    announcementsList.appendChild(li);
                });
            })
            .catch(error => {
                console.error('Error fetching parish announcements:', error);
                announcementsList.innerHTML = '<li>Failed to load parish announcements.</li>';
            });

        // Parish Events
        const eventsList = document.getElementById('events-list');
        eventsList.innerHTML = '<li>Loading events...</li>';
        fetch('data/parish-events.json')
            .then(response => response.json())
            .then(events => {
                eventsList.innerHTML = '';
                if (!Array.isArray(events) || events.length === 0) {
                    eventsList.innerHTML = '<li>No upcoming parish events at this time.</li>';
                    return;
                }
                events.forEach(event => {
                    const li = document.createElement('li');
                    li.className = 'list-item';
                    li.innerHTML = `
                        <h4>${event.title}</h4>
                        <p>${event.date}</p>
                        <p>${event.description}</p>
                    `;
                    eventsList.appendChild(li);
                });
            })
            .catch(error => {
                console.error('Error fetching parish events:', error);
                eventsList.innerHTML = '<li>Failed to load parish events.</li>';
            });

        // Mini Blog Slider Section
        const blogSlider = document.getElementById('blog-slider');
        const blogModal = document.getElementById('blog-modal');
    const blogModalImg = document.getElementById('blog-modal-img');
    const blogModalClose = document.getElementById('blog-modal-close');
    const blogModalPrev = document.getElementById('blog-modal-prev');
    const blogModalNext = document.getElementById('blog-modal-next');
    let blogModalImagesArr = [];
    let blogModalCurrentIndex = 0;
        let blogPosts = [];
        let currentBlogIndex = 0;
        let sliderInterval = null;

        function showBlogCard(index) {
            const post = blogPosts[index];
            if (!post) return;
            blogSlider.innerHTML = '';
            const div = document.createElement('div');
            div.className = 'blog-card blog-slider-card';
            div.innerHTML = `
                <div class="blog-slider-image-container">
                    <img src="${post.images && post.images.length ? post.images[0] : 'https://placehold.co/320x200/AAB7B8/FFFFFF?text=Image'}" alt="Blog Main Image" class="blog-slider-img" id="blog-main-img" style="cursor:pointer;" onerror="this.onerror=null;this.src='https://placehold.co/320x200/AAB7B8/FFFFFF?text=Image';">
                </div>
                <div class="blog-content">
                    <h3 class="blog-title">${post.title}</h3>
                    <p class="blog-desc">${post.description}</p>
                    <div class="blog-meta">
                        <span class="blog-date">${post.date}</span> |
                        <span class="blog-location">${post.location}</span>
                    </div>
                    <div class="blog-event-type">
                        ${post.eventType ? `<span class="event-type-label">${post.eventType.level}: ${post.eventType.group}</span>` : ''}
                    </div>
                </div>
            `;
            blogSlider.appendChild(div);

            // Add click event for main image to show modal
            const mainImg = div.querySelector('#blog-main-img');
            if (mainImg) {
                mainImg.onclick = function() {
                    showBlogModal(post.images);
                };
            }
        }

        function showBlogModal(images) {
            blogModalImagesArr = images || [];
            blogModalCurrentIndex = 0;
            updateBlogModalImage();
            blogModal.style.display = 'flex';
        }

        function updateBlogModalImage() {
            if (!blogModalImagesArr.length) {
                blogModalImg.src = 'https://placehold.co/320x200/AAB7B8/FFFFFF?text=Image';
                return;
            }
            blogModalImg.src = blogModalImagesArr[blogModalCurrentIndex];
            blogModalImg.onerror = function() { this.src = 'https://placehold.co/320x200/AAB7B8/FFFFFF?text=Image'; };
        }

        blogModalPrev.onclick = function(e) {
            e.stopPropagation();
            blogModalCurrentIndex = (blogModalCurrentIndex - 1 + blogModalImagesArr.length) % blogModalImagesArr.length;
            updateBlogModalImage();
        };
        blogModalNext.onclick = function(e) {
            e.stopPropagation();
            blogModalCurrentIndex = (blogModalCurrentIndex + 1) % blogModalImagesArr.length;
            updateBlogModalImage();
        };

        blogModalClose.onclick = function() {
            blogModal.style.display = 'none';
        };
        window.onclick = function(event) {
            if (event.target === blogModal) {
                blogModal.style.display = 'none';
            }
        };

        function startBlogSlider() {
            if (sliderInterval) clearInterval(sliderInterval);
            sliderInterval = setInterval(() => {
                currentBlogIndex = (currentBlogIndex + 1) % blogPosts.length;
                showBlogCard(currentBlogIndex);
            }, 4000);
        }

        fetch('data/blog.json')
            .then(response => response.json())
            .then(posts => {
                if (!Array.isArray(posts) || posts.length === 0) {
                    blogSlider.innerHTML = '<p>No blog posts found.</p>';
                    return;
                }
                blogPosts = posts;
                currentBlogIndex = 0;
                showBlogCard(currentBlogIndex);
                startBlogSlider();
            })
            .catch(error => {
                console.error('Error fetching blog posts:', error);
                blogSlider.innerHTML = '<p>Failed to load blog posts.</p>';
            });
    </script>
    <style>
        /* Blog Slider Styles */
        .blog-slider {
            position: relative;
            min-height: 320px;
            width: 100%;
            margin: 0;
        }
        .blog-slider-card {
            flex-direction: column;
            align-items: stretch;
            padding: 0;
            box-shadow: 0 2px 12px rgba(0,0,0,0.07);
            border-radius: 8px;
            background: #fff;
            display: flex;
            gap: 0;
            width: 100%;
        }
        .blog-slider-image-container {
            width: 100%;
            margin-bottom: 0;
        }
        .blog-slider-img {
            width: 100%;
            height: 340px;
            object-fit: cover;
            border-radius: 8px 8px 0 0;
            box-shadow: 0 1px 8px rgba(52,152,219,0.10);
            cursor: pointer;
            background: #eee;
            display: block;
        }
        /* Blog Modal Styles */
        .blog-modal {
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .blog-modal-content {
            background: none;
            padding: 0;
            border-radius: 0;
            box-shadow: none;
            max-width: 100vw;
            width: auto;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .blog-modal-close {
            position: absolute;
            top: -40px;
            right: 0;
            font-size: 2.5rem;
            color: #3498db;
            cursor: pointer;
            font-weight: bold;
            background: none;
            border: none;
        }
        #blog-modal-slider {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            width: 100%;
        }
        .blog-modal-img {
            width: 80vw;
            max-width: 700px;
            height: 60vh;
            object-fit: contain;
            border-radius: 12px;
            background: none;
            box-shadow: 0 2px 24px rgba(0,0,0,0.18);
        }
        .blog-modal-nav {
            background: rgba(255,255,255,0.8);
            border: none;
            font-size: 2.5rem;
            color: #3498db;
            cursor: pointer;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 12px rgba(0,0,0,0.10);
            transition: background 0.2s;
        }
        .blog-modal-nav:hover {
            background: #e6ff4a;
        }
        @media (max-width: 900px) {
            .blog-modal-img {
                width: 98vw;
                max-width: 98vw;
                height: 40vh;
            }
            .blog-modal-close {
                top: -30px;
                font-size: 2rem;
            }
            .blog-modal-nav {
                font-size: 2rem;
                width: 38px;
                height: 38px;
            }
        }
        @media (max-width: 900px) {
            .blog-slider-img {
                width: 100%;
                height: 160px;
            }
            .blog-modal-img {
                width: 100%;
                max-width: 220px;
                height: 120px;
            }
            .blog-modal-content {
                padding: 1rem;
            }
        }
        /* Mini Blog Section */
        .section-blog {
            margin-top: 2.5rem;
        }
        #blog-list {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .blog-card {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.07);
            padding: 1.2rem 1.5rem;
            display: flex;
            gap: 1.2rem;
            align-items: flex-start;
        }
        .blog-images {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .blog-img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 6px;
            background: #eee;
        }
        .blog-content {
            flex: 1;
        }
        .blog-title {
            font-family: 'Merriweather', serif;
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 0.3rem;
            color: #2c3e50;
        }
        .blog-desc {
            font-size: 1rem;
            color: #444;
            margin-bottom: 0.5rem;
        }
        .blog-meta {
            font-size: 0.95rem;
            color: #888;
            margin-bottom: 0.3rem;
        }
        .blog-event-type {
            font-size: 0.95rem;
            color: #3498db;
            font-weight: 500;
        }
        .event-type-label {
            background: #e6ff4a;
            color: #222;
            border-radius: 4px;
            padding: 2px 8px;
            font-size: 0.93rem;
            margin-right: 0.5rem;
        }
        @media (max-width: 900px) {
            .blog-card {
                flex-direction: column;
                align-items: stretch;
                padding: 1rem 0.7rem;
            }
            .blog-images {
                flex-direction: row;
                gap: 0.5rem;
                margin-bottom: 0.7rem;
            }
            .blog-img {
                width: 60px;
                height: 60px;
            }
        }
        /* General Body & Typography */
        body {
            font-family: 'Roboto', sans-serif;
            color: #444;
            background-color: #f7f7f7;
            margin: 0;
            padding: 0;
        }

        .main-content-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            padding: 2.5rem 1.5rem;
            max-width: 1200px;
            margin: 0 auto;
            box-sizing: border-box;
        }

        .main-column {
            flex: 2;
            min-width: 300px;
            margin-right: 2rem;
            box-sizing: border-box;
        }

        .sidebar-column {
            flex: 1;
            min-width: 250px;
            box-sizing: border-box;
        }

        /* Hero Section Styling (already provided, but included for completeness) */
        .blog-slider {
            position: relative;
            min-height: 320px;
            width: 100%;
            margin: 0 auto;
            box-sizing: border-box;
        }
        .blog-slider-card {
            flex-direction: column;
            align-items: stretch;
            padding: 0;
            box-shadow: 0 2px 12px rgba(0,0,0,0.07);
            border-radius: 8px;
            background: #fff;
            display: flex;
            gap: 0;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }
        .blog-slider-image-container {
            width: 100%;
            margin-bottom: 0;
            box-sizing: border-box;
        }
        .blog-slider-img {
            width: 100%;
            height: 340px;
            object-fit: cover;
            border-radius: 8px 8px 0 0;
            box-shadow: 0 1px 8px rgba(52,152,219,0.10);
            cursor: pointer;
            background: #eee;
            display: block;
            box-sizing: border-box;
        }
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(24, 24, 24, 0.18);
            border-radius: 18px;
            box-shadow: 0 2px 16px rgba(0, 0, 0, 0.10);
        }
        .hero-title {
            font-family: 'Merriweather', serif;
            font-size: 2.7rem;
            font-weight: 700;
            margin-bottom: 0.7rem;
            color: #e6ff4a;
            text-shadow: 0 2px 12px rgba(0, 0, 0, 0.18);
            letter-spacing: 1px;
        }
        .hero-subtitle {
            font-family: 'Roboto', sans-serif;
            font-size: 1.35rem;
            font-weight: 400;
            margin-bottom: 0;
            color: #fff;
            text-shadow: 0 1px 8px rgba(0, 0, 0, 0.18);
        }
        @media (max-width: 900px) {
            .hero {
                min-height: 220px;
            }
            .hero-title {
                font-size: 1.7rem;
            }
            .hero-content {
                padding: 1.2rem 0.5rem;
            }
            .hero-subtitle {
                font-size: 1rem;
            }
            .main-column {
                margin-right: 0;
            }
            .sidebar-column {
                margin-top: 2rem;
            }
        }

        /* New Styling Rules for Content Sections */
        .section-title {
            font-family: 'Merriweather', serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 1rem;
        }

        .section-subtitle {
            font-family: 'Merriweather', serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: #2c3e50;
            margin-top: 2.5rem;
            margin-bottom: 1.2rem;
        }

        .section-divider {
            border: none;
            height: 1px;
            background-color: #ddd;
            margin: 2.5rem 0;
        }

        .view-all-link {
            display: inline-block;
            font-family: 'Roboto', sans-serif;
            font-weight: bold;
            color: #3498db;
            text-decoration: none;
            margin-top: 1rem;
            transition: color 0.2s ease-in-out;
        }

        .view-all-link:hover {
            color: #2980b9;
            text-decoration: underline;
        }

        /* Sidebar Styling */
        .sidebar-section {
            background-color: #fff;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.07);
            margin-bottom: 1.5rem;
        }

        .sidebar-title {
            font-family: 'Roboto', sans-serif;
            font-size: 1.15rem;
            font-weight: bold;
            text-transform: uppercase;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
            letter-spacing: 0.5px;
        }

        /* Daily Readings Card Styling */
        #readings-content {
            margin-top: 1rem;
        }
        .reading-feast {
            font-size: 1rem;
            font-weight: 500;
            color: #444;
            margin-bottom: 0.7rem;
        }
        .reading-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .reading-card {
            background: #fff;
            border-radius: 7px;
            box-shadow: 0 1px 6px rgba(52,152,219,0.07);
            padding: 0.9rem 1.1rem;
            margin-bottom: 0.8rem;
            border-left: 5px solid #ffe066;
            transition: box-shadow 0.2s;
        }
        .reading-card:last-child {
            margin-bottom: 0;
        }
        .reading-title {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.07rem;
            margin-bottom: 0.2rem;
        }
        .reading-ref {
            font-size: 0.97rem;
            color: #888;
            font-style: italic;
        }
        @media (max-width: 900px) {
            .sidebar-section {
                padding: 1rem;
            }
            #readings-content {
                margin-top: 0.7rem;
            }
            .reading-card {
                padding: 0.7rem 0.7rem;
            }
        }

        /* Specific section styling adjustments */
        .mass-times-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .mass-times-list li {
            margin-bottom: 0.5rem;
        }
        
        #announcements-list {
            list-style: none;
            padding: 0;
        }

        .bulletin-item {
            border-bottom: 1px solid #eee;
            padding: 0.75rem 0;
            list-style: none;
        }

        .bulletin-item:last-child {
            border-bottom: none;
        }

        .bulletin-link {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
        }

        .bulletin-link:hover {
            text-decoration: underline;
        }
    </style>
    <script src="assets/js/main.js"></script>
</body>
</html>